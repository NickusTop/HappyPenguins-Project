import"./styles-45d29047.js";function T(e,t,s=0,l=20,c=!1){c&&(e.innerHTML="");const a=t.slice(s,s+l),i=a.map(n=>{if(!n)return"";const d=JSON.stringify(n.episode||[]);return`
            <ul class="character-ul"
                data-image="${n.image}"
                data-status="${n.status}"
                data-species="${n.species}"
                data-gender="${n.gender}"
                data-origin="${n.origin.name}"
                data-location="${n.location.name}"
                data-type="${n.type||""}"
                data-episode='${d}'>
                
                <img src="${n.image}" alt="" class="character-img">
                <h2 class="character-h2">${n.name}</h2>
                <p class="character-p">Origin: <span class="character-span">${n.origin.name}</span></p>
                <p class="character-p">Location: <span class="character-span">${n.location.name}</span></p>
            </ul>
            `}).join("");e.insertAdjacentHTML("beforeend",i);const o=new IntersectionObserver((n,d)=>{n.forEach(p=>{p.isIntersecting&&(p.target.classList.add("show"),d.unobserve(p.target))})},{threshold:.1});return e.querySelectorAll(".character-ul").forEach(n=>o.observe(n)),a.length}function H(e,t,s,l,c,a,i,o,r,n){const d=(p,g,h)=>{p.forEach(u=>{u.addEventListener("click",()=>{p.forEach(y=>{y.removeAttribute("name"),y.classList.remove("active")}),r.forEach(y=>y.classList.remove("active"));const m=u.textContent.trim();u.setAttribute("name",m),u.classList.add("active"),h.textContent=m,localStorage.setItem(g,m),n()})})};d(e,"selectedStatus",c),d(t,"selectedSpecies",a),d(s,"selectedType",i),d(l,"selectedGender",o)}function q(){const e=t=>(t||"").toLowerCase();return{selectedStatus:e(localStorage.getItem("selectedStatus")||"All"),selectedSpecies:e(localStorage.getItem("selectedSpecies")||"All"),selectedType:e(localStorage.getItem("selectedType")||"All"),selectedGender:e(localStorage.getItem("selectedGender")||"All"),selectedName:e(localStorage.getItem("selectedName")||""),toLower:e}}function x(e){return function(t){const{selectedStatus:s,selectedSpecies:l,selectedType:c,selectedGender:a,selectedName:i,toLower:o}=e,r=o(t.status),n=o(t.species),d=o(t.type),p=o(t.gender),g=o(t.name);return(s==="all"||r===s)&&(l==="all"||n===l)&&(c==="all"||d===c)&&(a==="all"||p===a)&&(i.length<3||g.includes(i))}}const j="https://rickandmortyapi.com/api/character/";async function $(e){try{const s=await(await fetch(j+`?page=${e}`)).json();return console.log(s),s.results}catch(t){console.log(t)}}async function k(e,t,s,l){let c=s,a=[],i=!0;for(;i&&a.length<t;){let o;try{o=await $(c)}catch{break}if(!o||o.length===0)break;const r=o.filter(e),n=l(r,c),d=t-a.length;a=a.concat(r.slice(0,d)),c++,(n===!1||c>42)&&(i=!1)}return{results:a,finalPage:c}}async function U(e){const{loadMorebtn:t}=e;if(e.pageList>42){t.style.display="none";return}const s=await $(e.pageList);if(!s){t.style.display="none";return}const l=q(),c=x(l),a=s.filter(c);t.style.display=a.length===0?"none":"block"}async function D(e){const{charactersList:t,filteredCharacters:s,loadMorebtn:l,noCharacters:c,countLoad:a}=e;t.style.opacity="0",t.innerHTML="",e.nextIndex=0,e.pageList=1,s.length=0;const i=q(),o=x(i);await new Promise(d=>setTimeout(d,150));const{results:r,finalPage:n}=await k(o,a,e.pageList,()=>!0);e.filteredCharacters=r,e.pageList=n,r.length===0?(l.style.display="none",c.style.display="flex"):(l.style.display="block",c.style.display="none"),T(t,r.slice(0,a),0,a,!0),t.style.opacity="1",e.nextIndex=a,await U(e)}async function O(e){const{charactersList:t,loadMorebtn:s}=e,l=document.querySelector(".characters-loader");s.disabled=!0,l.classList.add("active"),t.style.opacity="0",await new Promise(r=>setTimeout(r,150));const c=q(),a=x(c);let i=0;const{finalPage:o}=await k(a,e.countLoad,e.pageList,r=>{if(r.length===0)return!0;const n=r.slice(0,e.countLoad-i);return T(t,n,0,n.length,!1),i+=n.length,e.filteredCharacters=e.filteredCharacters.concat(r),i<e.countLoad});e.pageList=o,await U(e),s.disabled=!1,l.classList.remove("active"),t.style.opacity="1"}function f(e){return e&&e.replace(/\s*\(.*?\)/g,"").trim()}async function J(e,t){var p,g;const s=t.querySelector(".menu-img"),l=t.querySelector(".menu-status"),c=t.querySelector(".menu-species"),a=t.querySelector(".menu-gender"),i=t.querySelector(".menu-origin"),o=t.querySelector(".menu-location"),r=t.querySelector(".menu-type");t.classList.add("active"),s.src=e.image,l.textContent=f(e.status)||"Unknown",c.textContent=f(e.species)||"Unknown",a.textContent=f(e.gender)||"Unknown",i.textContent=f((p=e.origin)==null?void 0:p.name)||"Unknown",o.textContent=f((g=e.location)==null?void 0:g.name)||"Unknown",r.textContent=f(e.type)||"None";const n=t.querySelector(".menu-container-episodes");if(!n)return;if(n.innerHTML="",!e.episode||e.episode.length===0){n.insertAdjacentHTML("beforeend",'<p class="menu-container-p"></p>');return}const d=e.episode.map(h=>fetch(h).then(u=>u.ok?u.json():null).catch(()=>null));try{const h=await Promise.all(d);for(const u of h){if(!u)continue;const m=u.name,y=u.air_date,F=m.length>7?m.slice(0,7)+"...":m,A=u.episode.match(/S(\d+)E(\d+)/),G=A?A[1]:"??",w=document.createElement("ul");w.classList.add("menu-container-ul","menu-episodes-ul"),w.innerHTML=`
                <h4 class="menu-h4" title="${m}">${F}</h4>
                <li class="menu-container-li menu-container-ep-li">
                    <p class="menu-container-p">Season</p>
                    <span class="menu-container-span">${G}</span>
                </li>
                <li class="menu-container-li">
                    <p class="menu-container-p">Air date</p>
                    <span class="menu-container-span">${y}</span>
                </li>
            `,n.appendChild(w)}}catch{}}const E=document.querySelectorAll(".select-btn"),V=document.querySelectorAll(".select-ul"),v=document.querySelector(".characters-ul"),M=document.querySelector(".loadmore-btn"),S=document.querySelector(".filter-input"),L=document.querySelector(".header-input"),B=document.querySelector(".nocharacters-ul"),b=document.querySelector(".overflow-menu"),I=document.querySelector(".characters-loader");let W=document.querySelectorAll(".select-ul-status li"),_=document.querySelectorAll(".select-ul-species li"),z=document.querySelectorAll(".select-ul-type li"),K=document.querySelectorAll(".select-ul-gender li"),Q=document.querySelector(".status-text"),R=document.querySelector(".species-text"),X=document.querySelector(".type-text"),Y=document.querySelector(".gender-text");const Z=b.querySelector(".menu-btn");let N={nextIndex:0,countLoad:20,pageList:1,filteredCharacters:[],charactersList:v,loadMorebtn:M,noCharacters:B};function P(e){let t=e.trim().toLowerCase();t.length<3?localStorage.setItem("selectedName",""):localStorage.setItem("selectedName",t),C()}S.addEventListener("input",()=>{P(S.value),L.value=S.value});L.addEventListener("input",()=>{P(L.value),S.value=L.value});v.addEventListener("click",e=>{const t=e.target.closest(".character-ul");if(!t)return;let s=[];try{s=JSON.parse(t.dataset.episode)}catch{}const l={image:t.dataset.image,status:t.dataset.status,species:t.dataset.species,gender:t.dataset.gender,origin:{name:t.dataset.origin},location:{name:t.dataset.location},type:t.dataset.type,episode:s};J(l,b)});Z.addEventListener("click",()=>{b.classList.remove("active")});function ee(){E.forEach(e=>{e.addEventListener("click",()=>{let t=e.nextElementSibling,s=e.querySelector(".chevron-img");E.forEach(l=>{let c=l.nextElementSibling,a=l.querySelector(".chevron-img");c!==t&&(c.classList.remove("active"),a.classList.remove("rotate"))}),t.classList.toggle("active"),s.classList.toggle("rotate")})})}async function C(){I.classList.add("active"),v.style.opacity="0",await new Promise(e=>setTimeout(e,150)),await D(N),I.classList.remove("active"),v.style.opacity="1"}function te(){localStorage.setItem("selectedStatus","All"),localStorage.setItem("selectedSpecies","All"),localStorage.setItem("selectedType","All"),localStorage.setItem("selectedGender","All"),ee(),H(W,_,z,K,Q,R,X,Y,V,()=>C()),M.addEventListener("click",()=>O(N)),C()}te();

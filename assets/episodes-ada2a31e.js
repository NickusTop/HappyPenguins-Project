import"./styles-1f417456.js";const S="https://rickandmortyapi.com/api/episode",g=document.getElementById("searchInput"),v=document.getElementById("searchBtn"),C=document.getElementById("seasonSelect"),m=document.getElementById("episodesGrid"),s=document.getElementById("loadMoreBtn"),E=document.getElementById("emptyState");let r=1,h=null,i="",y=!1;const w={};async function B(t=1,n=""){const a=new URL(S);a.searchParams.set("page",t),n&&n.trim()!==""&&a.searchParams.set("name",n.trim());const e=await fetch(a.toString(),{headers:w});if(!e.ok){if(e.status===404)return{info:{pages:0},results:[]};throw new Error(`HTTP ${e.status}`)}return await e.json()}function x(t){const n=document.createElement("article");n.className="card";const a=document.createElement("div");a.className="title",a.textContent=t.name;const e=document.createElement("div");e.className="meta";const o=document.createElement("div");o.className="season";const d=document.createElement("span");d.style.opacity="0.65",d.textContent="Season";const l=document.createElement("span");l.style.fontSize="20px",l.textContent=L(t.episode);const f=document.createElement("div");return f.className="airdate",f.textContent=new Date(t.air_date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),o.appendChild(d),o.appendChild(l),e.appendChild(o),e.appendChild(f),n.appendChild(a),n.appendChild(e),n}function L(t){const n=String(t).match(/S0?(\d+)/i);return n?n[1]:"-"}function p(){m.innerHTML=""}function c(t){t?E.classList.remove("hidden"):E.classList.add("hidden")}function I(t,n="all"){const a=n==="all"?t:t.filter(e=>L(e.episode)===String(n));for(const e of a){const o=x(e);m.appendChild(o)}}async function u({page:t=1,query:n="",reset:a=!1}={}){if(!y){y=!0,s.disabled=!0,s.textContent="Loading...";try{const e=await B(t,n);h=e.info&&e.info.pages?e.info.pages:1,a&&p();const d=C.value;I(e.results||[],d);const l=m.children.length>0;c(!l),r=t,r>=h?s.style.display="none":(s.style.display="inline-block",s.disabled=!1,s.textContent="Load more")}catch(e){console.error(e),s.disabled=!1,s.textContent="Load more",m.children.length===0&&c(!0)}finally{y=!1}}}function N(t,n=300){let a;return function(...e){clearTimeout(a),a=setTimeout(()=>t.apply(this,e),n)}}const b=N(async()=>{i=g.value.trim(),r=1,p(),c(!1),await u({page:1,query:i,reset:!0})},350);g.addEventListener("input",b);v.addEventListener("click",()=>{i=g.value.trim(),r=1,p(),c(!1),u({page:1,query:i,reset:!0})});C.addEventListener("change",()=>{r=1,p(),c(!1),u({page:1,query:i,reset:!0})});s.addEventListener("click",async()=>{if(r>=(h||1))return;const t=r+1;await u({page:t,query:i,reset:!1})});(async function(){await u({page:1,query:"",reset:!0})})();
